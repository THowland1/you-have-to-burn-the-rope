{"mappings":"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","sources":["src/index.ts"],"sourcesContent":["import { audioManager } from './js/audio-manager';\nimport { axes } from './js/axes';\nimport { bg } from './js/bg';\nimport { boss } from './js/boss';\nimport { buttonManager } from './js/button-manager';\nimport { c, canvas, FRAME_HEIGHT, FRAME_WIDTH } from './js/canvas';\nimport { chandelier } from './js/chandelier';\nimport {\n  COURSE_HEIGHT,\n  COURSE_WIDTH,\n  DEBUG_DELAY,\n  SHOW_DEBUGMENU,\n  SHOW_GRIDLINES,\n  SHOW_PLATFORMS,\n} from './js/consts';\nimport { offset } from './js/coordinates';\nimport { debugMenu } from './js/debug-menu';\nimport { explosions } from './js/explosions';\nimport { flames } from './js/flames';\nimport { healthBar } from './js/healthbar';\nimport { lasers } from './js/lasers';\nimport { phaseManager, PHASES } from './js/phase-manager';\nimport { platforms } from './js/platforms';\nimport { player } from './js/player';\nimport { plumes } from './js/plumes';\nimport { rope } from './js/rope';\nimport { slides } from './js/slides';\nimport { timeManager } from './js/time-manager';\nimport { ASSET_URLS } from './js/urls';\n\nif ('serviceWorker' in navigator) {\n  window.addEventListener('load', () => {\n    navigator.serviceWorker\n      .register(ASSET_URLS['../serviceworker.js'], { type: 'module' })\n      .then((reg) => console.log('Success: ', reg.scope))\n      .catch((err) => console.log('Failure: ', err));\n  });\n}\n\ndocument.getElementById('canvas')!.addEventListener('click', () => {\n  phaseManager.startStartPhase();\n});\n\nfunction animate() {\n  const now = new Date().valueOf();\n  timeManager.msPerFrame = now - timeManager.now;\n  timeManager.now = now;\n\n  if (DEBUG_DELAY) {\n    setTimeout(() => {\n      requestAnimationFrame(animate);\n    }, DEBUG_DELAY);\n  } else {\n    requestAnimationFrame(animate);\n  }\n\n  c.clearRect(0, 0, canvas.width, canvas.height);\n\n  if (phaseManager.phase === PHASES.clicktostart) {\n    c.fillStyle = 'white';\n\n    c.textAlign = 'center';\n    c.font = '500 14px Inter';\n\n    c.fillText('Click to start', FRAME_WIDTH / 2, FRAME_HEIGHT / 2);\n    return;\n  }\n\n  if (audioManager.endCreditsMusic.currentTime < 2) {\n    bg.draw();\n    if (phaseManager.showBackDoor) {\n      phaseManager.drawBackDoor();\n    }\n\n    boss.update();\n    player.update();\n    rope.update();\n    chandelier.update();\n    explosions.update();\n    plumes.update();\n    axes.update();\n    lasers.update();\n    healthBar.update();\n\n    flames.forEach((flame) => flame.draw());\n    canvas.style.opacity = String(\n      (2 - audioManager.endCreditsMusic.currentTime) / 2\n    );\n    buttonManager.setOpacity(\n      (2 - audioManager.endCreditsMusic.currentTime) / 2\n    );\n  } else {\n    canvas.style.opacity = String(1);\n    buttonManager.hide();\n  }\n\n  if (player.left >= 108 * 32) {\n    phaseManager.startBossFightPhase();\n  } else if (player.left >= 6 * 32) {\n    phaseManager.startTunnelPhase();\n  }\n\n  c.fillStyle = 'white';\n  slides.forEach((slide) => slide.draw());\n\n  if (player.hasFlame && player.intersects(rope.flammableBitOfRope)) {\n    player.hasFlame = false;\n    phaseManager.startRopeBurningPhase();\n  }\n\n  if (SHOW_PLATFORMS) {\n    platforms.forEach((platform) => platform.draw());\n  }\n  if (SHOW_DEBUGMENU) {\n    debugMenu.draw();\n  }\n\n  if (SHOW_GRIDLINES) {\n    c.fillStyle = 'white';\n\n    Array.from(Array(COURSE_WIDTH / (32 * 4))).forEach((_, x) => {\n      c.fillRect(x * (32 * 4) - offset.x, 0, 1, FRAME_HEIGHT);\n      c.fillText(`${x * 4}`, x * (32 * 4) - offset.x, 10);\n    });\n\n    Array.from(Array(COURSE_HEIGHT / (32 * 5))).forEach((_, y) => {\n      c.fillRect(0, y * (32 * 5) - offset.y, FRAME_WIDTH, 1);\n      c.fillText(`${y * 5}`, 10, y * (32 * 5) - offset.y);\n    });\n  }\n\n  if (\n    player.localRight > 400 &&\n    offset.x + FRAME_WIDTH < COURSE_WIDTH &&\n    player.velocity.x > 0\n  ) {\n    offset.x += player.velocity.x * timeManager.msPerFrame;\n  } else if (player.localLeft < 200 && offset.x > 0 && player.velocity.x < 0) {\n    offset.x += player.velocity.x * timeManager.msPerFrame;\n  }\n  if (player.localTop < 175 && offset.y > 0 && player.velocity.y < 0) {\n    offset.y += player.velocity.y * timeManager.msPerFrame;\n  } else if (\n    player.localBottom > 200 &&\n    offset.y + FRAME_HEIGHT < COURSE_HEIGHT &&\n    player.velocity.y > 0\n  ) {\n    offset.y += player.velocity.y * timeManager.msPerFrame;\n  }\n}\nanimate();\n"],"names":["$fhmpD","parcelRequire","navigator","window","addEventListener","serviceWorker","register","$hdaJi","ASSET_URLS","type","then","reg","console","log","scope","catch","err","document","getElementById","$gjplt","phaseManager","startStartPhase","$b4e14b6b8da86996$var$animate","now","Date","valueOf","$k2Jgz","timeManager","msPerFrame","$23Gzg","DEBUG_DELAY","setTimeout","requestAnimationFrame","$lH8pK","c","clearRect","canvas","width","height","phase","PHASES","clicktostart","fillStyle","textAlign","font","fillText","FRAME_WIDTH","FRAME_HEIGHT","audioManager","endCreditsMusic","currentTime","$i6XKk","bg","draw","showBackDoor","drawBackDoor","$iAOOi","boss","update","$dG7qe","player","$bVu7s","rope","$eO54F","chandelier","$2QuBt","explosions","$9PeYs","plumes","$6vGfG","axes","$3baFF","lasers","$l0bXA","healthBar","$8BsEr","flames","forEach","flame","style","opacity","String","$hIz9Q","buttonManager","setOpacity","hide","left","startBossFightPhase","startTunnelPhase","$6Wh8A","slides","slide","hasFlame","intersects","flammableBitOfRope","startRopeBurningPhase","SHOW_PLATFORMS","$1m88l","platforms","platform","SHOW_DEBUGMENU","$7KYR5","debugMenu","SHOW_GRIDLINES","Array","from","COURSE_WIDTH","_","x","fillRect","$ePQeA","offset","COURSE_HEIGHT","y","localRight","velocity","localLeft","localTop","localBottom"],"version":3,"file":"yhtbtr.d34dc7dd.js.map"}